#!/usr/bin/env python
import os, sys, codecs
import argparse
import rstslide

print("rstslide: ReStructuredText HTML slide generator.")

# Test the presence of Pygments
isPygments=False
try:
    from pygments.styles import STYLE_MAP
    isPygments=True
except:
    print("Pygments is not installed, code blocks won't be highlighted")

# Allowed themes and transitions
themes = ['default', 'beige', 'night']
transitions = ['default', 'cube', 'page', 'concave', 'zoom', 'linear', 'fade', 'none']
options=['input_file', 'output_file', 'theme', 'transition', 'mathjax_path', 'pygments_style']
if isPygments:
    pygments_styles=STYLE_MAP.keys()

# Define arguments 
parser = argparse.ArgumentParser()
parser.description="""rstslide: ReST to Reveal.js slide generator."""
parser.add_argument("input_file", help="The name of the ReStructuredText file to parse.")
parser.add_argument("-o", "--output_file", type=str, help="The name of the HTML5 file to produce (by default the same basename as the input file with a .html suffix.")
args = parser.parse_args()
   
# input file name
filename = args.input_file
# output file name   
if args.output_file:
    output_file = args.output_file
else:
    output_file = filename.split('.')[-2]+'.html' 

# Create the RST parser and create the slides
parser = rstslide.Parser(input_file=filename, output_file=output_file)
                                
parser.create_slides()
print('The output is in', parser.output_file)
